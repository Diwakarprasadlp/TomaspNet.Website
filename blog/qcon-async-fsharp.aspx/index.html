<!DOCTYPE html>
<!--[if IE 8]> 				 <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<head>
  <meta charset="utf-8">
  <title>Asynchronous client/server in F# (QCon 2012)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Last week, I gave a talk on asynchronous programming in F# at QCon London. I used the one hour slot to implement a Social Rectangle Drawing App - an application that showed the importance of asynchronous workflows on both client-side and server-side.">
  <meta name="author" content="Tomas Petricek">

  <!-- Reference Foundation -->
  <link rel="stylesheet" href="http://tomasp.net/css/foundation.css">
  <script src="js/vendor/custom.modernizr.js"></script>

  <link rel="alternate" type="application/rss+xml" href="http://tomasp.net/rss.xml" title="RSS feed for Tomas Petricek's blog">
  <link rel="icon" type="image/png" href="http://tomasp.net/img/favicon.png" />

  <!-- Reference custom CSS and tooltips -->
  <link type="text/css" rel="stylesheet" href="http://tomasp.net/custom/style.css" />
  <script type="text/javascript" src="http://tomasp.net/custom/tooltips.js"></script>
  <link type="text/css" rel="stylesheet" href="http://tomasp.net/custom/tooltips.css" />
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <meta name="twitter:card" content="summary">
  <meta name="twitter:creator" content="@tomaspetricek">
  <meta name="twitter:title" content="Asynchronous client/server in F# (QCon 2012)">
  <meta name="twitter:description" content="Last week, I gave a talk on asynchronous programming in F# at QCon London. I used the one hour slot to implement a Social Rectangle Drawing App - an application that showed the importance of asynchronous workflows on both client-side and server-side.">
</head>
<body>

   <header id="top-header">
    <div class="row">
      <div class="twelve columns">
        <h1><a href="http://tomasp.net/">Tomas Petricek's blog</a></h1>
        <p>Writing about practical F# coding and programming language research</p>
      </div>
    </div>
  </header>

  <header class="top-bar-header">
    <div class="contain-to-grid sticky">
    <nav class="top-bar">

    <ul class="title-area">
      <li class="name"><h1><a href="#"></a></h1></li>
      <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>
    <section class="top-bar-section">
      <ul class="right">
        <li><a href="http://tomasp.net/blog/index.html">Blog</a></li>
        <li><a href="http://functional-programming.net">Books</a></li>
        <li><a href="http://fsharpworks.com/workshops.html">Trainings</a></li>
        <li><a href="http://fsharpworks.com">Consulting</a></li>
        <li><a href="http://tomasp.net/academic">Research</a></li>
      </ul>
    </section>

    </nav></div>
  </header>

  
<div class="row">
	<div class="large-8 columns main-content">
    <content>
      
<h1>Asynchronous client/server in F# (QCon 2012)</h1>
<img src="http://tomasp.net/articles/qcon-async-fsharp/qcon.png" alt="Qcon" class="rdecor" />

<p>Last week, I gave a talk on asynchronous programming in F# at <a href="http://qconlondon.com/london-2012">London QCon 2012</a>.
The talk was a part of <a href="http://qconlondon.com/london-2012/tracks/show_track.jsp?trackOID=560">The Rise of Scala & Functional Programming</a> 
track organized by Charles Humble. Reactive and asynchronous programming was a topic that was repeated
a couple of times during the whole session - Sadek Drobi talked about <a href="http://qconlondon.com/london-2012/presentation/Non%20blocking,%20composable%20reactive%20web%20programming%20with%20Iteratees%20in%20Play2">non-blocking reactive web framework
Play2</a>
and Damien Katz talked about <a href="http://qconlondon.com/london-2012/presentation/Erlang%20in%20the%20real%20world:%20CouchDB">Erlang and CouchDB</a>.</p>

<p>I used the one hour slot to implement "Rectangle Drawing App" - a simple application that 
shows how to write complete client-server application just using F#. On the
server-side, I used asynchronous workflows to write HTTP server with an F#
agent. On the client-side, I used asynchronous workflows to express user
interface logic and the <a href="http://pitfw.org/">Pit project</a> to run F# code as
JavaScript that works everywhere. The app definitely had a huge commercial potential:</p>

<div style="text-align:center">
<img src="http://tomasp.net/articles/qcon-async-fsharp/quote.png" alt="Quote" />
</div>

<h2>Asynchronous programming everywhere</h2>

<p>In the F# asynchronous programming model, you can write code that does not block
the executing thread, but can be written in the sequential style using standard
control-flow constructs such as loops and exception handlers. This is quite
different to what Play2 or Node.js use. These are essentially based on the
event-based programming model. However, this comes with inversion of control and
so we cannot use standard language features. With asynchronous programming in F#, 
you can write <em>parallel code</em> as well as <em>sequential code</em>.</p>

<p>Explaining the importance of asynchronous (non-blocking) code is quite easy. Just
look at the following slide and you'll see why asynchronous programming should be
used on both server-side and client-side:</p>

<div style="text-align:center">
<img src="http://tomasp.net/articles/qcon-async-fsharp/async.png" />
</div>

<p>To give a longer explanation, here are the key reasons:</p>

<ul>
<li><p>On the <strong>server-side</strong>, asynchronous programming means that server is able to
handle a large number of concurrent requests using fewer threads. When performing
I/O operations (such as using file system or database), other requests can be
processed on the same thread.</p></li>
<li><p>On the <strong>client-side</strong>, asynchronous programming makes it easier to express 
long-running interaction patterns. For example, drawing of a rectangle starts by
pressing a button, continues by moving a mouse and ends by releasing of the button.
Asynchronous programming gives you a way to directly encode this description.</p></li>
</ul>

<p>I already wrote about both of these topics elsewhere, so if you want to learn more,
look at the following articles:</p>

<ul>
<li><a href="http://dotnetslackers.com/articles/net/Programming-user-interfaces-using-f-sharp-workflows.aspx">Programming user interfaces using F# workflows</a>
explains how to encode drag&drop or rectangle drawing using F# asynchronous workflows
(this is an article excerpt from Chapter 16 of <a href="http://manning.com/petricek">my book</a>).</li>
<li><a href="http://tomasp.net/blog/async-non-blocking-gui.aspx">Writing non-blocking user interfaces in F#</a>
is my recent blog post that combines user-interface programming and web service calls.</li>
<li><a href="http://msdn.microsoft.com/en-us/library/hh297112.aspx">Server-side programming with F# agents</a>
is a series of articles for MSDN that explain asynchronous and agent-based programming in F#.</li>
</ul>

<h2>Translating F# to JavaScript</h2>

<p>For the client-side part of my demo application, I decided to use F# running as JavaScript using
the excellent open-source <a href="http://pitfw.org/">F# to JavaScript translator called Pit</a>. If you've been
following my blog, you know that translating F# to JavaScript is a topic that <a href="http://tomasp.net/blog/fswebtools-intro.aspx">I've been interested
for a long time</a>.</p>

<p>The Pit project is quite nice, because it does not try to do anything unnecessary. It lets you
write code in F# and translates it to JavaScript. If you want some advanced abstractions for
building web pages, you can implement them in F#. Pit project re-implements some of the standard
F# libraries (e.g. for working with lists). In my demo, I wanted to use asynchronous workflows
for GUI programming. Asynchronous workflows are not included in Pit, but it turns out that it was
quite easy to re-implement them (see the source code at the end of the article).</p>

<p>When running as JavaScript, asynchronous workflows aren't useful for parallel programming, but
they provide a great abstraction for making asynchronous AJAX calls and for implementing
user-interface logic. To implement social rectangle drawing application, I needed to encode
the following two state machines:</p>

<div style="text-align:center">
<img src="http://tomasp.net/articles/qcon-async-fsharp/gui.png" />
</div>

<p>I won't explain the complete source code in this article. The rectangle drawing sample is already
discussed in my book (Chapter 16) and in <a href="http://dotnetslackers.com/articles/net/Programming-user-interfaces-using-f-sharp-workflows.aspx">this book excerpt</a>.
The other workflow, which obtains the current state from the server and updates the displayed
rectangles shows a few interesting aspects of writing client-side code in F# using Pit:</p>

<pre class="fssnip">
<span class="c">/// Asynchronously download retangles from the server</span>
<span class="c">/// and decode the JSON format to F# Rectangle record</span>
<span class="k">let</span> [&lt;<span onmouseout="hideTip(event, 'ft16', 46)" onmouseover="showTip(event, 'ft16', 46)" class="i">Js</span>&gt;] <span onmouseout="hideTip(event, 'ft25', 47)" onmouseover="showTip(event, 'ft25', 47)" class="i">getRectangles</span> () <span class="o">:</span> <span onmouseout="hideTip(event, 'ft26', 48)" onmouseover="showTip(event, 'ft26', 48)" class="i">Async</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'ft8', 49)" onmouseover="showTip(event, 'ft8', 49)" class="i">Rectangle</span>[]<span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'ft27', 50)" onmouseover="showTip(event, 'ft27', 50)" class="i">async</span> {
  <span class="k">let</span> <span onmouseout="hideTip(event, 'ft28', 51)" onmouseover="showTip(event, 'ft28', 51)" class="i">req</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'ft29', 52)" onmouseover="showTip(event, 'ft29', 52)" class="i">XMLHttpRequest</span>()
  <span onmouseout="hideTip(event, 'ft28', 53)" onmouseover="showTip(event, 'ft28', 53)" class="i">req</span><span class="o">.</span><span onmouseout="hideTip(event, 'ft30', 54)" onmouseover="showTip(event, 'ft30', 54)" class="i">Open</span>(<span class="s">&quot;</span><span class="s">POST</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">/</span><span class="s">get</span><span class="s">&quot;</span>, <span class="k">true</span>)
  <span class="k">let!</span> <span onmouseout="hideTip(event, 'ft31', 55)" onmouseover="showTip(event, 'ft31', 55)" class="i">resp</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'ft28', 56)" onmouseover="showTip(event, 'ft28', 56)" class="i">req</span><span class="o">.</span><span onmouseout="hideTip(event, 'ft32', 57)" onmouseover="showTip(event, 'ft32', 57)" class="i">AsyncSend</span>()
  <span class="k">return</span> <span onmouseout="hideTip(event, 'ft33', 58)" onmouseover="showTip(event, 'ft33', 58)" class="i">JSON</span><span class="o">.</span><span onmouseout="hideTip(event, 'ft34', 59)" onmouseover="showTip(event, 'ft34', 59)" class="i">parse</span>(<span class="i">resp</span>) }

<span class="c">/// Repeatedly update rectangles after 0.5 sec</span>
<span class="k">let</span> [&lt;<span onmouseout="hideTip(event, 'ft16', 60)" onmouseover="showTip(event, 'ft16', 60)" class="i">Js</span>&gt;] <span onmouseout="hideTip(event, 'ft35', 61)" onmouseover="showTip(event, 'ft35', 61)" class="i">updateLoop</span> () <span class="o">=</span> <span onmouseout="hideTip(event, 'ft27', 62)" onmouseover="showTip(event, 'ft27', 62)" class="i">async</span> {
  <span class="k">while</span> <span class="k">true</span> <span class="k">do</span> 
    <span class="k">do!</span> <span onmouseout="hideTip(event, 'ft26', 63)" onmouseover="showTip(event, 'ft26', 63)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'ft36', 64)" onmouseover="showTip(event, 'ft36', 64)" class="i">Sleep</span>(<span class="n">500</span>)
    <span class="k">let!</span> <span onmouseout="hideTip(event, 'ft37', 65)" onmouseover="showTip(event, 'ft37', 65)" class="i">rects</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'ft25', 66)" onmouseover="showTip(event, 'ft25', 66)" class="i">getRectangles</span>()
    <span onmouseout="hideTip(event, 'ft38', 67)" onmouseover="showTip(event, 'ft38', 67)" class="i">cleanRectangles</span>()
    <span class="i">rects</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'ft39', 68)" onmouseover="showTip(event, 'ft39', 68)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'ft40', 69)" onmouseover="showTip(event, 'ft40', 69)" class="i">iter</span> <span onmouseout="hideTip(event, 'ft17', 70)" onmouseover="showTip(event, 'ft17', 70)" class="i">createRectangle</span> }</pre>


<p>The source code from the talk includes a couple of browser-based asynchronous operations. 
The first one is <code>AsyncSend</code> method of <code>XMLHttpRequest</code>, which sends the request to the
server and then waits (without blocking), until the response is received. This means that
<code>getRectangles</code> is not going to block the browser, but we can still use sequential 
programming style to implement it. After receiving the response as a string, the function
calls <code>JSON.parse</code> to parse a standard JSON formatted data into an array of F# record 
values of type <code>Rectangle</code>.</p>

<p>The <code>updateLoop</code> function is also interesting. We don't want to initiate a new request
every 0.5 seconds (in case the server is still processing the previous request). With
asynchronous workflows, this is quite easy - the body of the loop waits 0.5 seconds, then
asynchronously calls the server and updates the GUI. The next iteration of the loop only
starts after the previous update completes (which corresponds to the above diagram).</p>

<h2>Audience participation</h2>

<p>A great thing about creating a client/server demo is that people can actually try it 
live while I was finishing my talk. The fact that the client-side of the demo used just 
JavaScript means that everybody was able to try it - when I put the link on the slide,
people opened the site in their smart phones (I could see a few iPhones around) and
created the following piece of modern <a href="http://en.wikipedia.org/wiki/Digital_art">digital art</a>:</p>

<div style="text-align:center">
<img src="http://tomasp.net/articles/qcon-async-fsharp/painting.jpg" />
</div>

<h2>Links and materials</h2>

<p>If you want to play with the sample, create a client-side F# application running
as JavaScript or look at the slides from the talk, here are some useful links:</p>

<ul>
<li><a href="https://github.com/tpetricek/Documents/tree/master/Talks%202012/Async%20Client-Server%20(QCon%20London)">Asynchronous, client-server F#</a> - Talk materials at GitHub</li>
<li><a href="http://www.slideshare.net/tomaspfb/qcon-11955404">Asynchronous programming on the server and the client in F#</a> on SlideShare</li>
<li><a href="http://pitfw.org/">Pit - F# to JavaScript translator</a> - Project homepage</li>
<li><a href="https://github.com/fsharp/pitfw">Pit - source code</a> - Available on GitHub</li>
</ul>


<!-- HTML for Tool Tips -->

<div class="tip" id="ft1">namespace Pit</div>
<div class="tip" id="ft2">namespace Pit.Dom</div>
<div class="tip" id="ft3">namespace Pit.Async</div>
<div class="tip" id="ft4">namespace Pit.Javascript</div>
<div class="tip" id="ft5">namespace SocialDrawing</div>
<div class="tip" id="ft6">module Dom<br /><br />from SocialDrawing</div>
<div class="tip" id="ft7">module Colors<br /><br />from SocialDrawing</div>
<div class="tip" id="ft8">type Rectangle =<br />&#160;&#160;{X1: int;<br />&#160;&#160;&#160;Y1: int;<br />&#160;&#160;&#160;X2: int;<br />&#160;&#160;&#160;Y2: int;<br />&#160;&#160;&#160;Color: string;}<br /><br />Full name: Blog.Rectangle<br /><br />&#160;&#160;type: Rectangle<br />&#160;&#160;implements: System.IEquatable&lt;Rectangle&gt;<br />&#160;&#160;implements: System.Collections.IStructuralEquatable<br />&#160;&#160;implements: System.IComparable&lt;Rectangle&gt;<br />&#160;&#160;implements: System.IComparable<br />&#160;&#160;implements: System.Collections.IStructuralComparable<br /></div>
<div class="tip" id="ft9">Rectangle.X1: int</div>
<div class="tip" id="ft10">Multiple items<br />val int : &#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;<br /><br />&#160;&#160;type: int&lt;&#39;Measure&gt;<br />&#160;&#160;implements: System.IComparable<br />&#160;&#160;implements: System.IConvertible<br />&#160;&#160;implements: System.IFormattable<br />&#160;&#160;implements: System.IComparable&lt;int&lt;&#39;Measure&gt;&gt;<br />&#160;&#160;implements: System.IEquatable&lt;int&lt;&#39;Measure&gt;&gt;<br />&#160;&#160;inherits: System.ValueType<br /><br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />&#160;&#160;type: int<br />&#160;&#160;implements: System.IComparable<br />&#160;&#160;implements: System.IFormattable<br />&#160;&#160;implements: System.IConvertible<br />&#160;&#160;implements: System.IComparable&lt;int&gt;<br />&#160;&#160;implements: System.IEquatable&lt;int&gt;<br />&#160;&#160;inherits: System.ValueType<br /></div>
<div class="tip" id="ft11">Rectangle.Y1: int</div>
<div class="tip" id="ft12">Rectangle.X2: int</div>
<div class="tip" id="ft13">Rectangle.Y2: int</div>
<div class="tip" id="ft14">Rectangle.Color: string</div>
<div class="tip" id="ft15">Multiple items<br />val string : &#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string<br /><br />&#160;&#160;type: string<br />&#160;&#160;implements: System.IComparable<br />&#160;&#160;implements: System.ICloneable<br />&#160;&#160;implements: System.IConvertible<br />&#160;&#160;implements: System.IComparable&lt;string&gt;<br />&#160;&#160;implements: seq&lt;char&gt;<br />&#160;&#160;implements: System.Collections.IEnumerable<br />&#160;&#160;implements: System.IEquatable&lt;string&gt;<br /></div>
<div class="tip" id="ft16">type Js = ReflectedDefinitionAttribute<br /><br />Full name: Pit.Js<br /><br />&#160;&#160;type: Js<br />&#160;&#160;implements: System.Runtime.InteropServices._Attribute<br />&#160;&#160;inherits: System.Attribute<br /></div>
<div class="tip" id="ft17">val createRectangle : Rectangle -&gt; unit<br /><br />Full name: Blog.createRectangle</div>
<div class="tip" id="ft18">val rect : Rectangle<br /><br />&#160;&#160;type: Rectangle<br />&#160;&#160;implements: System.IEquatable&lt;Rectangle&gt;<br />&#160;&#160;implements: System.Collections.IStructuralEquatable<br />&#160;&#160;implements: System.IComparable&lt;Rectangle&gt;<br />&#160;&#160;implements: System.IComparable<br />&#160;&#160;implements: System.Collections.IStructuralComparable<br /></div>
<div class="tip" id="ft19">val el : DomElement<br /><br />&#160;&#160;type: DomElement<br />&#160;&#160;inherits: DomObject<br /></div>
<div class="tip" id="ft20">val createSelection : unit -&gt; DomElement<br /><br />Full name: SocialDrawing.Dom.createSelection</div>
<div class="tip" id="ft21">property DomElement.ClassName: string</div>
<div class="tip" id="ft22">property DomElement.Style: DomStyle</div>
<div class="tip" id="ft23">property DomStyle.BackgroundColor: string</div>
<div class="tip" id="ft24">val moveElement : DomElement -&gt; int * int -&gt; int * int -&gt; unit<br /><br />Full name: SocialDrawing.Dom.moveElement</div>
<div class="tip" id="ft25">val getRectangles : unit -&gt; Async&lt;Rectangle []&gt;<br /><br />Full name: Blog.getRectangles<br /><em><br /><br />&#160;Asynchronously download retangles from the server<br />&#160;and decode the JSON format to F# Rectangle record</em></div>
<div class="tip" id="ft26">Multiple items<br />namespace Pit.Async<br /><br />--------------------<br />type Async&lt;&#39;T&gt; = | Cont of ((&#39;T -&gt; unit) -&gt; unit)<br /><br />Full name: Pit.Async.Async&lt;_&gt;<br /><br />--------------------<br />type Async =<br />&#160;&#160;class<br />&#160;&#160;&#160;&#160;static member AwaitEvent : event:IEvent&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;static member AwaitEvent : event1:IEvent&lt;&#39;T1&gt; * event2:IEvent&lt;&#39;T2&gt; -&gt; Async&lt;Choice&lt;&#39;T1,&#39;T2&gt;&gt;<br />&#160;&#160;&#160;&#160;static member Sleep : milliseconds:int -&gt; Async&lt;unit&gt;<br />&#160;&#160;&#160;&#160;static member StartImmediate : workflow:Async&lt;unit&gt; -&gt; unit<br />&#160;&#160;end<br /><br />Full name: Pit.Async.AsyncTopLevel.Async</div>
<div class="tip" id="ft27">val async : AsyncBuilder<br /><br />Full name: Pit.Async.AsyncTopLevel.async</div>
<div class="tip" id="ft28">val req : XMLHttpRequest</div>
<div class="tip" id="ft29">type XMLHttpRequest =<br />&#160;&#160;class<br />&#160;&#160;&#160;&#160;new : unit -&gt; XMLHttpRequest<br />&#160;&#160;&#160;&#160;member Abort : unit -&gt; unit<br />&#160;&#160;&#160;&#160;member GetAllResponseHeaders : unit -&gt; string<br />&#160;&#160;&#160;&#160;member GetResponseHeader : unit -&gt; string<br />&#160;&#160;&#160;&#160;member Open : methodType:string * url:string * async:bool -&gt; unit<br />&#160;&#160;&#160;&#160;member Send : data:string -&gt; unit<br />&#160;&#160;&#160;&#160;member SetRequestHeader : key:string * value:string -&gt; unit<br />&#160;&#160;&#160;&#160;member ReadyState : int<br />&#160;&#160;&#160;&#160;member ResponseText : string<br />&#160;&#160;&#160;&#160;member ResponseXML : System.Windows.Browser.ScriptObject<br />&#160;&#160;&#160;&#160;member Status : obj<br />&#160;&#160;&#160;&#160;member StatusText : string<br />&#160;&#160;&#160;&#160;member OnReadyStateChange : (unit -&gt; unit) with set<br />&#160;&#160;end<br /><br />Full name: Pit.Javascript.XMLHttpRequest</div>
<div class="tip" id="ft30">member XMLHttpRequest.Open : methodType:string * url:string * async:bool -&gt; unit</div>
<div class="tip" id="ft31">val resp : string<br /><br />&#160;&#160;type: string<br />&#160;&#160;implements: System.IComparable<br />&#160;&#160;implements: System.ICloneable<br />&#160;&#160;implements: System.IConvertible<br />&#160;&#160;implements: System.IComparable&lt;string&gt;<br />&#160;&#160;implements: seq&lt;char&gt;<br />&#160;&#160;implements: System.Collections.IEnumerable<br />&#160;&#160;implements: System.IEquatable&lt;string&gt;<br /></div>
<div class="tip" id="ft32">member XMLHttpRequest.AsyncSend : unit -&gt; Async&lt;string&gt;</div>
<div class="tip" id="ft33">module JSON<br /><br />from Pit.Javascript</div>
<div class="tip" id="ft34">val parse : string -&gt; &#39;a<br /><br />Full name: Pit.Javascript.JSON.parse</div>
<div class="tip" id="ft35">val updateLoop : unit -&gt; Async&lt;unit&gt;<br /><br />Full name: Blog.updateLoop<br /><em><br /><br />&#160;Repeatedly update rectangles after 0.5 sec</em></div>
<div class="tip" id="ft36">Multiple items<br />static member Async.Sleep : milliseconds:int -&gt; Async&lt;unit&gt;<br /><br />--------------------<br />static member Async.Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;</div>
<div class="tip" id="ft37">val rects : Rectangle []<br /><br />&#160;&#160;type: Rectangle []<br />&#160;&#160;implements: System.ICloneable<br />&#160;&#160;implements: System.Collections.IList<br />&#160;&#160;implements: System.Collections.ICollection<br />&#160;&#160;implements: System.Collections.IStructuralComparable<br />&#160;&#160;implements: System.Collections.IStructuralEquatable<br />&#160;&#160;implements: System.Collections.Generic.IList&lt;Rectangle&gt;<br />&#160;&#160;implements: System.Collections.Generic.ICollection&lt;Rectangle&gt;<br />&#160;&#160;implements: seq&lt;Rectangle&gt;<br />&#160;&#160;implements: System.Collections.IEnumerable<br />&#160;&#160;inherits: System.Array<br /></div>
<div class="tip" id="ft38">val cleanRectangles : unit -&gt; unit<br /><br />Full name: SocialDrawing.Dom.cleanRectangles</div>
<div class="tip" id="ft39">module Array<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="ft40">val iter : (&#39;T -&gt; unit) -&gt; &#39;T [] -&gt; unit<br /><br />Full name: Microsoft.FSharp.Collections.Array.iter</div>


<div class="row">
  <div class="small-6 columns"><p class="post-discuss">
		Discuss <a href="http://twitter.com/tomaspetricek">on twitter</a>, <script type="text/javascript" src="http://www.reddit.com/buttonlite.js?i=0"></script>.<br />
		Send corrections via <a href="https://github.com/tpetricek/TomaspNet.Website">GitHub pull requests</a>.
	</p></div>
  <div class="small-6 columns">

<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style addthis_16x16_style">
<a class="addthis_button_twitter"></a>
<a class="addthis_button_reddit"></a>
<a class="addthis_button_google_plusone_share"></a>
<a class="addthis_button_hackernews"></a>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = { "data_track_addressbar": false };</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-521c32162e6001a0"></script>
<!-- AddThis Button END -->

<p class="post-meta">
  <span><strong>Published</strong> Monday, 12 March 2012, 1:09 AM</span><br />      
  <span><strong>By</strong> <a href="https://plus.google.com/+TomasPetriceks?rel=author">Tomas Petricek</a></span><br />
  <span class="tags"><strong>Tags</strong> Presentations,Functional Programming in .NET,Asynchronous,F# language,Materials & Links</span>
</p>

  </div>
</div>

    </content>

  </div>
  <div class="large-4 columns" id="right-bar">
    <div class="right-item" id="right-calendar">
<script type="text/javascript">
  var monthNames =
    ["January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"];
  var d = new Date();
  var m = monthNames[d.getMonth()];
  var y = d.getFullYear();
  var ml = m.toLowerCase();
  document.writeln("<h4>Calendar - " + m + " " + y + "</h4>");
  document.writeln("<a href=\"http://tomasp.net/calendar/" + y + "/" + ml + ".html\">" +
    "<img src=\"http://tomasp.net/calendar/" + y + "/" + ml + "-preview.jpg\" style=\"border-style:none;\" />" +
    "</a>");
</script>
<p>The calendar shows a new picture each month. See photos for
  <a href="http://tomasp.net/calendar/2005">2005</a>, <a href="http://tomasp.net/calendar/2006">2006</a>,
  <a href="http://tomasp.net/calendar/2007">2007</a>, <a href="http://tomasp.net/calendar/2008">2008</a>,
  <a href="http://tomasp.net/calendar/2009">2009</a>, <a href="http://tomasp.net/calendar/2010">2010</a>,
  <a href="http://tomasp.net/calendar/2011">2011</a>, <a href="http://tomasp.net/calendar/2012">2012</a>,
  <a href="http://tomasp.net/calendar/2013">2013</a>, <a href="http://tomasp.net/calendar/2014">2014</a>,
  <a href="http://tomasp.net/calendar/2015">2015</a>
  and the first photos of <a href="http://tomasp.net/calendar/2016">2016</a>.
</p>
</div>


    <h3>Welcome!</h3>
    <img src="http://tomasp.net/img/tomas.jpg" alt="Tomas Petricek" style="float:right;margin:10px 0px 10px 10px;" />
    <p>I'm an F# open-source developer, book author and computer scientist. I submitted my PhD thesis recently.
      When offline, I enjoy traveling and taking pictures. You can find me at
      at <a href="http://twitter.com/tomaspetricek">@tomaspetricek</a> or email 
      <a href="mailto:tomas@tomasp.net">tomas@tomasp.net</a>.
    </p>

    <h4>Trainings and consulting</h4>
    <a href="http://fsharpworks.com"><img src="http://tomasp.net/img/fsharpworks.png" alt="fsharpWorks" style="float:right;margin:15px 0px 10px 10px; width:150px" /></a>
    <p>I'm an experienced F# developer and trainer. <br /> I offer training and consulting
      services through <a href="http://fsharpworks.com">fsharpWorks</a>.
    </p>
    <ul>
      <li>Check out my <a href="http://fsharpworks.com/workshops/fast-track.html">in-person Fast Track to F#</a> course</li>
      <li>Check out my <a href="http://fsharpworks.com/workshops/finance.html">online F# in Finance</a> course</li>
      <li><a href="mailto:tomas@tomasp.net">Email me</a> for info about private trainings</li>
    </ul>
    
    <script type="text/javascript" src="http://tomasp.net/news/news.js"></script>
    <h4>What's new? &#160; <small><script type="text/javascript">document.write(news.date)</script></small></h4>
    <script>
      document.write(news.info);
    </script>

    <h4>Functional F# and C# books</h4>
    <div style="float:right;">
      <a href="http://www.amazon.com/gp/product/1933988924/ref=as_li_tf_il?ie=UTF8&tag=httptomasnet-20&linkCode=as2&camp=217145&creative=399369&creativeASIN=1933988924">
        <img src="http://tomasp.net/img/deepdives.png" alt="F# Deep Dives" style="float:right;margin:15px 0px 15px 10px;border-style:none;" />
      </a>
    </div>
    <p>
      I wrote or contributed to two books on F# and functional programming:
      <a href="http://functional-programming.net/rwfp">Real World Functional Programming</a> explains functional
      concepts using F# and C# and <a href="http://functional-programming.net/deepdives">F# Deep Dives</a> is a 
      collection of case studies written by industry experts.</p>
    <ul>
      <li><a href="http://functional-programming.net/rwfp"><strong>Real World Functional Programming</strong></a> home page. See
        <a href="http://manning.com/petricek">Manning</a>,
        <a href="https://www.amazon.com/dp/1933988924?tag=httptomasnet-20&camp=213381&creative=390973&linkCode=as4&creativeASIN=1933988924&adid=0F1DP260JGG4KY0CDGP6">Amazon.com</a> or
        <a href="https://www.amazon.co.uk/dp/1933988924?tag=tomasnet-21&camp=1406&creative=6394&linkCode=as1&creativeASIN=1933988924&adid=1CTY87YCCQEJW965GNDF">Amazon.co.uk</a>.
      </li>
      <li><a href="http://functional-programming.net/deepdives"><strong>F# Deep Dives</strong></a> home page. Get it from
        <a href="http://www.manning.com/petricek2">Manning.com</a>,
        <a href="http://www.amazon.com/gp/product/1617291323/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1617291323&linkCode=as2&tag=httptomasnet-20&linkId=U4FPJJSKKCCKGNHD">Amazon.com</a> or
        <a href="http://www.amazon.co.uk/gp/product/1617291323/ref=as_li_tl?ie=UTF8&camp=1634&creative=19450&creativeASIN=1617291323&linkCode=as2&tag=tomasnet-21&linkId=HTUYVHHGWB4Q7X6V">Amazon.co.uk</a>.
      </li>
    </ul>    
    <p>I also wrote a series of tutorials on <a href="http://www.tryfsharp.org/Learn/financial-computing">financial computing for Try F#</a>.
      This interactive environment let's you try F# in the browser.</p>

    <h4>Research and teaching</h4>
    <img src="http://tomasp.net/img/cam.png" alt="University of Cambride" style="float:right;margin:25px 0px 10px 10px;" />
    <p>I submitted my PhD thesis at the <a href="http://www.cl.cam.ac.uk/">University of Cambridge</a>,
      working on making better types for programs that run in rich context (like F# type providers, distributed 
      prog&shy;ramming or data-flow). See <a href="http://tomasp.net/academic/">my academic page</a> for
      more.</p>

    <h4>Blog tags</h4>
    <p>

      <a href="http://tomasp.net/blog/tag/fsharp/">f#</a>&nbsp;(109),       <a href="http://tomasp.net/blog/tag/research/">research</a>&nbsp;(34),       <a href="http://tomasp.net/blog/tag/functional-programming/">functional programming</a>&nbsp;(18),       <a href="http://tomasp.net/blog/tag/csharp/">c#</a>&nbsp;(36),       <a href="http://tomasp.net/blog/tag/data-science/">data science</a>&nbsp;(6),       <a href="http://tomasp.net/blog/tag/web/">web</a>&nbsp;(10),       <a href="http://tomasp.net/blog/tag/talks/">talks</a>&nbsp;(7),       <a href="http://tomasp.net/blog/tag/philosophy/">philosophy</a>&nbsp;(4),       <a href="http://tomasp.net/blog/tag/fslab/">fslab</a>&nbsp;(4),       <a href="http://tomasp.net/blog/tag/programming-languages/">programming languages</a>&nbsp;(3),       <a href="http://tomasp.net/blog/tag/type-providers/">type providers</a>&nbsp;(3),       <a href="http://tomasp.net/blog/tag/data-journalism/">data journalism</a>&nbsp;(2),       <a href="http://tomasp.net/blog/tag/linq/">linq</a>&nbsp;(3),       <a href="http://tomasp.net/blog/tag/coeffects/">coeffects</a>&nbsp;(2),       <a href="http://tomasp.net/blog/tag/deedle/">deedle</a>&nbsp;(2),       <a href="http://tomasp.net/blog/tag/visualization/">visualization</a>&nbsp;(1),       <a href="http://tomasp.net/blog/tag/machine-learning/">machine learning</a>&nbsp;(1)    </p>

  </div>
</div>


  <div class="row" id="footer">
  <footer>
    <div class="large-3 columns">
      <h4>Contact & about</h4>
      <p>This site is hosted on GitHub and is generated using <a href="https://github.com/tpetricek/FSharp.Formatting">F# Formatting</a>.
        For more info, see the <a href="https://github.com/tpetricek/TomaspNet.Website">website source on GitHub</a>.
      </p>
      <p>Please submit issues & corrections on GitHub. Use pull requests for minor corrections only.</p>
      <ul>
        <li>Email me: <a href="mailto:tomas@tomasp.net">tomas@tomasp.net</a></li>
        <li>Connect via Twitter: <a href="http://twitter.com/tomaspetricek">@tomaspetricek</a></li>
        <li>More: <a href="http://uk.linkedin.com/in/tomaspetricek">LinkedIn</a> | <a href="http://lanyrd.com/profile/tomasp/">Lanyrd</a> | <a href="https://github.com/tpetricek">GitHub</a></li>
      </ul>
    </div>
    <div class="large-7 columns">
    <h4>Blog archives <a href="http://tomasp.net/rss.xml"><img src="http://tomasp.net/img/rss.gif" /></a></h4>
      <a href="http://tomasp.net/blog/archive/april-2016/index.html">
        April 2016 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2015/index.html">
        December 2015 (2)</a>,      <a href="http://tomasp.net/blog/archive/november-2015/index.html">
        November 2015 (1)</a>,      <a href="http://tomasp.net/blog/archive/september-2015/index.html">
        September 2015 (3)</a>,      <a href="http://tomasp.net/blog/archive/july-2015/index.html">
        July 2015 (1)</a>,      <a href="http://tomasp.net/blog/archive/june-2015/index.html">
        June 2015 (1)</a>,      <a href="http://tomasp.net/blog/archive/may-2015/index.html">
        May 2015 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2015/index.html">
        April 2015 (3)</a>,      <a href="http://tomasp.net/blog/archive/march-2015/index.html">
        March 2015 (2)</a>,      <a href="http://tomasp.net/blog/archive/february-2015/index.html">
        February 2015 (1)</a>,      <a href="http://tomasp.net/blog/archive/january-2015/index.html">
        January 2015 (2)</a>,      <a href="http://tomasp.net/blog/archive/december-2014/index.html">
        December 2014 (1)</a>,      <a href="http://tomasp.net/blog/archive/may-2014/index.html">
        May 2014 (3)</a>,      <a href="http://tomasp.net/blog/archive/april-2014/index.html">
        April 2014 (2)</a>,      <a href="http://tomasp.net/blog/archive/march-2014/index.html">
        March 2014 (1)</a>,      <a href="http://tomasp.net/blog/archive/january-2014/index.html">
        January 2014 (2)</a>,      <a href="http://tomasp.net/blog/archive/december-2013/index.html">
        December 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/november-2013/index.html">
        November 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/october-2013/index.html">
        October 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/september-2013/index.html">
        September 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/august-2013/index.html">
        August 2013 (2)</a>,      <a href="http://tomasp.net/blog/archive/may-2013/index.html">
        May 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/april-2013/index.html">
        April 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/march-2013/index.html">
        March 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/february-2013/index.html">
        February 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/january-2013/index.html">
        January 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2012/index.html">
        December 2012 (2)</a>,      <a href="http://tomasp.net/blog/archive/october-2012/index.html">
        October 2012 (1)</a>,      <a href="http://tomasp.net/blog/archive/august-2012/index.html">
        August 2012 (3)</a>,      <a href="http://tomasp.net/blog/archive/june-2012/index.html">
        June 2012 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2012/index.html">
        April 2012 (1)</a>,      <a href="http://tomasp.net/blog/archive/march-2012/index.html">
        March 2012 (4)</a>,      <a href="http://tomasp.net/blog/archive/february-2012/index.html">
        February 2012 (5)</a>,      <a href="http://tomasp.net/blog/archive/january-2012/index.html">
        January 2012 (2)</a>,      <a href="http://tomasp.net/blog/archive/november-2011/index.html">
        November 2011 (5)</a>,      <a href="http://tomasp.net/blog/archive/august-2011/index.html">
        August 2011 (3)</a>,      <a href="http://tomasp.net/blog/archive/july-2011/index.html">
        July 2011 (2)</a>,      <a href="http://tomasp.net/blog/archive/june-2011/index.html">
        June 2011 (2)</a>,      <a href="http://tomasp.net/blog/archive/may-2011/index.html">
        May 2011 (2)</a>,      <a href="http://tomasp.net/blog/archive/march-2011/index.html">
        March 2011 (4)</a>,      <a href="http://tomasp.net/blog/archive/december-2010/index.html">
        December 2010 (1)</a>,      <a href="http://tomasp.net/blog/archive/november-2010/index.html">
        November 2010 (6)</a>,      <a href="http://tomasp.net/blog/archive/october-2010/index.html">
        October 2010 (6)</a>,      <a href="http://tomasp.net/blog/archive/september-2010/index.html">
        September 2010 (4)</a>,      <a href="http://tomasp.net/blog/archive/july-2010/index.html">
        July 2010 (3)</a>,      <a href="http://tomasp.net/blog/archive/june-2010/index.html">
        June 2010 (2)</a>,      <a href="http://tomasp.net/blog/archive/may-2010/index.html">
        May 2010 (1)</a>,      <a href="http://tomasp.net/blog/archive/february-2010/index.html">
        February 2010 (2)</a>,      <a href="http://tomasp.net/blog/archive/january-2010/index.html">
        January 2010 (3)</a>,      <a href="http://tomasp.net/blog/archive/december-2009/index.html">
        December 2009 (3)</a>,      <a href="http://tomasp.net/blog/archive/july-2009/index.html">
        July 2009 (1)</a>,      <a href="http://tomasp.net/blog/archive/june-2009/index.html">
        June 2009 (3)</a>,      <a href="http://tomasp.net/blog/archive/may-2009/index.html">
        May 2009 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2009/index.html">
        April 2009 (1)</a>,      <a href="http://tomasp.net/blog/archive/march-2009/index.html">
        March 2009 (2)</a>,      <a href="http://tomasp.net/blog/archive/february-2009/index.html">
        February 2009 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2008/index.html">
        December 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/november-2008/index.html">
        November 2008 (5)</a>,      <a href="http://tomasp.net/blog/archive/october-2008/index.html">
        October 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/september-2008/index.html">
        September 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/june-2008/index.html">
        June 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/march-2008/index.html">
        March 2008 (3)</a>,      <a href="http://tomasp.net/blog/archive/february-2008/index.html">
        February 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2007/index.html">
        December 2007 (2)</a>,      <a href="http://tomasp.net/blog/archive/november-2007/index.html">
        November 2007 (6)</a>,      <a href="http://tomasp.net/blog/archive/october-2007/index.html">
        October 2007 (1)</a>,      <a href="http://tomasp.net/blog/archive/september-2007/index.html">
        September 2007 (1)</a>,      <a href="http://tomasp.net/blog/archive/august-2007/index.html">
        August 2007 (1)</a>,      <a href="http://tomasp.net/blog/archive/july-2007/index.html">
        July 2007 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2007/index.html">
        April 2007 (2)</a>,      <a href="http://tomasp.net/blog/archive/march-2007/index.html">
        March 2007 (3)</a>,      <a href="http://tomasp.net/blog/archive/february-2007/index.html">
        February 2007 (3)</a>,      <a href="http://tomasp.net/blog/archive/january-2007/index.html">
        January 2007 (2)</a>,      <a href="http://tomasp.net/blog/archive/november-2006/index.html">
        November 2006 (1)</a>,      <a href="http://tomasp.net/blog/archive/october-2006/index.html">
        October 2006 (3)</a>,      <a href="http://tomasp.net/blog/archive/august-2006/index.html">
        August 2006 (2)</a>,      <a href="http://tomasp.net/blog/archive/july-2006/index.html">
        July 2006 (1)</a>,      <a href="http://tomasp.net/blog/archive/june-2006/index.html">
        June 2006 (3)</a>,      <a href="http://tomasp.net/blog/archive/may-2006/index.html">
        May 2006 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2006/index.html">
        April 2006 (2)</a>,      <a href="http://tomasp.net/blog/archive/december-2005/index.html">
        December 2005 (1)</a>,      <a href="http://tomasp.net/blog/archive/july-2005/index.html">
        July 2005 (4)</a>,      <a href="http://tomasp.net/blog/archive/june-2005/index.html">
        June 2005 (5)</a>,      <a href="http://tomasp.net/blog/archive/may-2005/index.html">
        May 2005 (1)</a>,      <a href="http://tomasp.net/blog/archive/april-2005/index.html">
        April 2005 (3)</a>,      <a href="http://tomasp.net/blog/archive/march-2005/index.html">
        March 2005 (3)</a>,      <a href="http://tomasp.net/blog/archive/january-2005/index.html">
        January 2005 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2004/index.html">
        December 2004 (3)</a>,      <a href="http://tomasp.net/blog/archive/november-2004/index.html">
        November 2004 (2)</a>,    </div>
    <div class="large-2 columns">
      <h4>License</h4>
      <p>Unless explicitly mentioned, all articles on this site are licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution Share Alike</a>.
        All source code samples are licensed under Apache 2.0.
      </p>
      <img src="http://tomasp.net/img/cc-sa.png" alt="CC License logo" />
    </div>
  </footer>
  </div>

  <script>
  document.write('<script src=' +
  ('__proto__' in {} ? 'http://tomasp.net/js/vendor/zepto' : 'http://tomasp.net/js/vendor/jquery') +
  '.js><\/script>')
  </script>

  <script src="http://tomasp.net/js/foundation.min.js"></script>
  <script>
    $(document).foundation();
  </script>
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1561220-1']);
    _gaq.push(['_trackPageview']);

    (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
  <script src="http://cdn.lanyrd.net/badges/person-v1.min.js"></script>
</body>
</html>
